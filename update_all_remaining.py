import json
from pathlib import Path

TEXTS_FILE = Path("texts.json")

# === ПЛАНЕТЫ В ЗНАКАХ (ОСТАЛЬНЫЕ) ===
social_transpersonal = {
    "Jupiter": {
        "Ari": "Юпитер в Овне дарит удачу тем, кто смел и инициативен. Вы лидер, который вдохновляет других своим энтузиазмом. Успех приходит через первопроходчество и активные действия.",
        "Tau": "Юпитер в Тельце приносит удачу в материальных делах. Вы умеете приумножать богатство, цените комфорт и качество. Успех приходит через терпение, стабильность и создание надежного фундамента.",
        "Gem": "Юпитер в Близнецах расширяет кругозор через общение и обучение. Вы вечный студент, удачливы в торговле, журналистике и посредничестве. Успех приходит через связи и информацию.",
        "Cnc": "Юпитер в Раке (в экзальтации) дарит невероятную интуицию и покровительство рода. Вы щедры, заботливы, удачливы в вопросах недвижимости и семьи. Успех приходит через заботу о других и патриотизм.",
        "Leo": "Юпитер во Льве любит масштаб, роскошь и публичность. Вы артистичны, великодушны, удачливы в шоу-бизнесе и творчестве. Успех приходит, когда вы сияете и дарите тепло окружающим.",
        "Vir": "Юпитер в Деве (в изгнании) ищет смысл в деталях и служении. Вы удачливы в медицине, науке и кропотливой работе. Успех приходит через профессионализм, порядок и помощь людям.",
        "Lib": "Юпитер в Весах приносит удачу через партнерство и дипломатию. Вы справедливы, эстетичны, удачливы в юриспруденции и искусстве. Успех приходит через умение договариваться и создавать гармонию.",
        "Sco": "Юпитер в Скорпионе дарует мощную интуицию и способность к трансформации. Вы удачливы в финансах, бизнесе и оккультизме. Успех приходит через кризисы, риск и умение видеть скрытое.",
        "Sag": "Юпитер в Стрельце (в обители) — самое сильное положение. Вы оптимист, философ, путешественник. Удача сопутствует вам везде. Успех приходит через преподавание, иностранные связи и духовный рост.",
        "Cap": "Юпитер в Козероге (в падении) сдержан и амбициозен. Удача не падает с неба, а зарабатывается трудом. Вы отличный администратор. Успех приходит через карьеру, дисциплину и социальный статус.",
        "Aqu": "Юпитер в Водолее приносит удачу через друзей, коллективы и новые технологии. Вы гуманист и реформатор. Успех приходит через оригинальные идеи, интернет и общественную деятельность.",
        "Pis": "Юпитер в Рыбах (в обители) дарует милосердие, духовность и творческий дар. Вы интуитивны, удачливы в искусстве и психологии. Успех приходит через веру, сострадание и помощь обездоленным."
    },
    "Saturn": {
        "Ari": "Сатурн в Овне (в падении) создает трудности с инициативой. Вы учитесь терпению и сдержанности через конфликты. Вам нужно выработать стратегию, а не биться головой о стену.",
        "Tau": "Сатурн в Тельце требует упорства в материальных вопросах. Вы боитесь бедности, поэтому работаете на износ. Вам нужно учиться наслаждаться жизнью, не экономя на всем.",
        "Gem": "Сатурн в Близнецах дисциплинирует ум. Вы серьезны в учебе и общении, не любите пустую болтовню. Вам нужно преодолеть страх показаться глупым и учиться легкости.",
        "Cnc": "Сатурн в Раке (в изгнании) дает эмоциональную зажатость. Вы боитесь показать уязвимость, строите стены вокруг себя. Урок — научиться доверять близким и создать семью.",
        "Leo": "Сатурн во Льве ограничивает творческое самовыражение. Вы боитесь публики или критики. Урок — развить внутренний стержень и не зависеть от аплодисментов.",
        "Vir": "Сатурн в Деве дает перфекционизм и трудоголизм. Вы критичны к мелочам, боитесь хаоса. Урок — научиться видеть целое за деталями и не изводить себя работой.",
        "Lib": "Сатурн в Весах (в экзальтации) — мастер договоренностей. Вы серьезно относитесь к браку и партнерству. Справедливы, ответственны. Урок — не терпеть плохие отношения ради приличий.",
        "Sco": "Сатурн в Скорпионе дает страх перед переменами и глубиной. Вы контролируете свои страсти и чужие деньги. Урок — научиться отпускать и доверять жизненному потоку.",
        "Sag": "Сатурн в Стрельце проверяет вашу веру и убеждения. Вы можете быть догматиком. Урок — расширить горизонты и найти свою истинную философию, а не следовать правилам.",
        "Cap": "Сатурн в Козероге (в обители) — сильнейшее положение. Вы амбициозны, дисциплинированы, выносливы. Карьерист. Урок — не забывать о душе в погоне за статусом.",
        "Aqu": "Сатурн в Водолее (в обители) дает научный склад ума и ответственность перед обществом. Вы верный друг, но эмоционально холодны. Урок — сочетать структуру с новизной.",
        "Pis": "Сатурн в Рыбах дает страхи, фобии и чувство одиночества. Вам трудно структурировать свой хаос. Урок — найти духовный стержень и служить людям, не теряя себя."
    },
    "Uranus": {
        "Ari": "Поколение новаторов и бунтарей. Стремление к абсолютной свободе и переменам.",
        "Tau": "Реформы в экономике и финансах. Новое отношение к собственности и земле.",
        "Gem": "Революция в средствах связи и информации. Гениальные идеи, быстрое мышление.",
        "Cnc": "Перемены в традициях и семейном укладе. Свободные отношения в семье.",
        "Leo": "Свобода в творчестве и любви. Новые формы искусства и самовыражения.",
        "Vir": "Внедрение технологий в работу и медицину. Компьютеризация рутины.",
        "Lib": "Свободные браки, новые формы партнерства. Реформы в правосудии.",
        "Sco": "Сексуальная революция, интерес к магии и трансформации. Глубокие кризисы.",
        "Sag": "Реформы в религии и образовании. Открытие новых горизонтов и путешествия.",
        "Cap": "Смена политических структур и власти. Разрушение старых иерархий.",
        "Aqu": "Эпоха братства, науки и гуманизма. Расцвет астрологии и IT.",
        "Pis": "Пробуждение духовности, интерес к мистике и психологии. Размытие границ."
    },
    "Neptune": {
        "Ari": "Духовный поиск через борьбу и идеализм. Новые религиозные течения.",
        "Tau": "Материализация мечты, идеализация красоты и природы.",
        "Gem": "Мистика в литературе, обман в информации, интуитивное знание.",
        "Cnc": "Глубокая эмоциональность, идеализация родины и семьи.",
        "Leo": "Романтизм в искусстве, идеализация любви. «Золотой век» кино.",
        "Vir": "Внимание к здоровому образу жизни, химия, фармацевтика.",
        "Lib": "Идеалы гармонии, мира и справедливости. Расцвет дипломатии.",
        "Sco": "Интерес к подсознанию, сексу и магии. Глубокие психологические трансформации.",
        "Sag": "Духовные странствия, идеализм в религии и философии.",
        "Cap": "Размытие структур, хаос в управлении, но и духовная дисциплина.",
        "Aqu": "Мечты о всеобщем братстве, утопические идеи, гуманизм.",
        "Pis": "Глубочайшая духовность, мистика, музыка, жертвенность. Эпоха психологии."
    },
    "Pluto": {
        "Ari": "Трансформация личности через борьбу. Эпоха войн и передела мира.",
        "Tau": "Перестройка финансовой системы. Борьба за ресурсы и территории.",
        "Gem": "Трансформация СМИ и коммуникаций. Манипуляция информацией.",
        "Cnc": "Глубинные перемены в семье и нации. Защита своих корней.",
        "Leo": "Власть творчества и самовыражения. Диктат моды и кумиров.",
        "Vir": "Трансформация медицины и труда. Борьба за экологию и здоровье.",
        "Lib": "Перестройка системы брака и правосудия. Новые нормы отношений.",
        "Sco": "Сексуальная революция, власть больших денег, мафия, атомная энергия.",
        "Sag": "Трансформация религии и мировоззрения. Глобализация.",
        "Cap": "Разрушение старых империй и государственных структур. Борьба за власть.",
        "Aqu": "Революции, свобода, научные прорывы. Трансформация общества.",
        "Pis": "Глубинные психологические сдвиги, тайная власть, религия."
    },
    "North_node": {
        "Ari": "Задача: стать лидером, проявить инициативу, быть смелым и независимым. Опираться на партнерство (Весы), но идти своим путем.",
        "Tau": "Задача: накапливать ресурсы, создавать комфорт, ценить материю. Опираться на кризисы (Скорпион), но стремиться к стабильности.",
        "Gem": "Задача: учиться, общаться, передавать информацию. Опираться на мудрость (Стрелец), но быть проще и доступнее.",
        "Cnc": "Задача: создать семью, уют, проявить заботу. Опираться на карьеру (Козерог), но выбрать дом и душу.",
        "Leo": "Задача: творить, сиять, быть центром внимания. Опираться на коллектив (Водолей), но проявить свою индивидуальность.",
        "Vir": "Задача: служить, работать, наводить порядок. Опираться на интуицию (Рыбы), но быть практичным и точным.",
        "Lib": "Задача: строить отношения, договариваться, быть дипломатом. Опираться на себя (Овен), но учитывать интересы партнера.",
        "Sco": "Задача: рисковать, трансформироваться, идти в глубину. Опираться на комфорт (Телец), но не бояться кризисов.",
        "Sag": "Задача: быть учителем, философом, путешественником. Опираться на факты (Близнецы), но видеть общую картину.",
        "Cap": "Задача: строить карьеру, брать ответственность, достигать целей. Опираться на семью (Рак), но идти к вершине.",
        "Aqu": "Задача: быть свободным, дружить, внедрять новое. Опираться на творчество (Лев), но думать о благе всех.",
        "Pis": "Задача: верить, медитировать, помогать, любить безусловно. Опираться на логику (Дева), но слушать сердце."
    },
    "South_node": {
        "Ari": "Наработанный опыт: лидерство, агрессия, самостоятельность. Нужно уходить от эгоизма к партнерству.",
        "Tau": "Наработанный опыт: накопительство, стабильность, комфорт. Нужно учиться рисковать и отпускать.",
        "Gem": "Наработанный опыт: легкость, общение, поверхностность. Нужно искать глубокий смысл и мудрость.",
        "Cnc": "Наработанный опыт: семья, эмоции, зависимость. Нужно строить карьеру и взрослеть.",
        "Leo": "Наработанный опыт: слава, творчество, эгоцентризм. Нужно учиться дружить и быть равным.",
        "Vir": "Наработанный опыт: труд, критика, мелочность. Нужно расслабиться и довериться потоку.",
        "Lib": "Наработанный опыт: компромиссы, зависимость от партнера. Нужно проявить самостоятельность.",
        "Sco": "Наработанный опыт: власть, манипуляции, кризисы. Нужно искать покой и стабильность.",
        "Sag": "Наработанный опыт: учительство, догматизм, путешествия. Нужно учиться простому общению.",
        "Cap": "Наработанный опыт: карьера, жесткость, одиночество. Нужно создать семью и проявить мягкость.",
        "Aqu": "Наработанный опыт: свобода, революции, отстраненность. Нужно раскрыть свое сердце и творчество.",
        "Pis": "Наработанный опыт: жертвенность, иллюзии, уединение. Нужно работать и приносить конкретную пользу."
    },
    "Lilith": {
        "Ari": "Искушение агрессией и насилием. Страх быть слабым. Кармическая задача — научиться управлять своим гневом и быть честным воином.",
        "Tau": "Искушение жадностью и накопительством. Страх нищеты. Кармическая задача — не привязываться к вещам и деньгам.",
        "Gem": "Искушение ложью, сплетнями и воровством интеллектуальной собственности. Кармическая задача — быть честным в словах.",
        "Cnc": "Искушение родовыми проклятиями, манипуляциями в семье. Кармическая задача — проработать отношения с мамой и родом.",
        "Leo": "Искушение гордыней, тщеславием и игрой на публику. Кармическая задача — творить не ради славы, а от души.",
        "Vir": "Искушение мелочностью, критиканством и ипохондрией. Кармическая задача — служить людям бескорыстно.",
        "Lib": "Искушение лже-дипломатией, изменами и ненадежностью. Кармическая задача — быть верным и честным партнером.",
        "Sco": "Искушение магией, сексом, насилием и властью. Самое сильное положение. Кармическая задача — трансформировать свои пороки.",
        "Sag": "Искушение лже-учительством и фанатизмом. Кармическая задача — уважать чужую веру и не навязывать свое мнение.",
        "Cap": "Искушение деспотизмом, карьеризмом и жестокостью. Кармическая задача — не идти по головам ради цели.",
        "Aqu": "Искушение анархией, предательством друзей и хулиганством. Кармическая задача — ценить свободу, но не нарушать чужие границы.",
        "Pis": "Искушение алкоголем, наркотиками, обманом и иллюзиями. Кармическая задача — сохранять ясность ума и помогать страждущим."
    }
}

# === ПЛАНЕТЫ В ДОМАХ ===
houses_texts = {
    "Sun": {
        "1": "Солнце в 1 доме: Вы яркая, заметная личность. Лидер по натуре. Ваша самореализация зависит только от вас. Важно следить за имиджем.",
        "2": "Солнце во 2 доме: Ваша энергия направлена на заработок и накопление. Вы цените красивые вещи. Финансовый успех важен для самооценки.",
        "3": "Солнце в 3 доме: Вы общительны, любознательны. Реализация через контакты, поездки, обучение, братьев/сестер и писательство.",
        "4": "Солнце в 4 доме: Ваша сила в семье и корнях. Домосед, патриот. Реализация через недвижимость, создание уюта и продолжение рода.",
        "5": "Солнце в 5 доме: Дом творчества, любви и детей. Вы артистичны, азартны. Жизнь для вас — сцена. Успех в шоу-бизнесе или спорте.",
        "6": "Солнце в 6 доме: Реализация через труд, служение и заботу о здоровье. Вы трудоголик, цените порядок. Успех в медицине или сервисе.",
        "7": "Солнце в 7 доме: Вам нужен партнер, чтобы сиять. Успех в публичной деятельности, консультировании и браке. Зависимы от оценки других.",
        "8": "Солнце в 8 доме: Вас тянет к риску, бизнесу и магии. Жизнь полна кризисов, которые делают вас сильнее. Успех в управлении чужими деньгами.",
        "9": "Солнце в 9 доме: Вы философ, учитель, путешественник. Стремитесь к расширению горизонтов. Успех за границей или в науке.",
        "10": "Солнце в 10 доме: Дом карьеры и славы. Вы амбициозны, стремитесь к власти и признанию. Рождены руководить. Успех в политике.",
        "11": "Солнце в 11 доме: Вы общественный деятель, реформатор. Друзья играют огромную роль. Успех в IT, астрологии или коллективных проектах.",
        "12": "Солнце в 12 доме: Вы скрытный человек, любите уединение. Интерес к эзотерике и психологии. Успех в закрытых учреждениях или творчестве."
    },
    "Moon": {
        "1": "Луна в 1 доме: Вы очень эмоциональны, переменчивы, капризны. Лицо выдает все чувства. Сильная связь с мамой. Важно заботиться о себе.",
        "2": "Луна во 2 доме: Деньги дают чувство безопасности. Нестабильный доход: то густо, то пусто. Тратите на еду и дом.",
        "3": "Луна в 3 доме: Эмоциональное обучение. Школа и соседи сильно влияли в детстве. Любите душевные разговоры и поездки.",
        "4": "Луна в 4 доме (в обители): Сильная привязанность к дому и родителям. Интуиция. Важно иметь свое надежное убежище.",
        "5": "Луна в 5 доме: Вы любите детей, праздники, романтику. Творческая натура. В любви ищете заботу и эмоциональный отклик.",
        "6": "Луна в 6 доме: Эмоции влияют на здоровье. Забота проявляется через бытовую помощь. Хорошо завести домашнее животное.",
        "7": "Луна в 7 доме: Эмоциональная зависимость от партнера. Ищете в муже/жене «мамочку». Переменчивость в отношениях.",
        "8": "Луна в 8 доме: Тревожность, страхи, но и мощная интуиция. Кризисы переживаются глубоко. Интерес к мистике и сексу.",
        "9": "Луна в 9 доме: Душа отдыхает в путешествиях. Интерес к чужим культурам. Может быть эмиграция или мама-иностранка.",
        "10": "Луна в 10 доме: Популярность, карьера в женских сферах. Эмоции на виду. Мама сыграла роль в выборе профессии.",
        "11": "Луна в 11 доме: Друзья — ваша семья. Вы мечтатель, идеалист. Эмоциональная потребность в свободе и новизне.",
        "12": "Луна в 12 доме: Скрытые эмоции, ранимость. Психологический дар. Хорошо для медитаций и жизни на природе."
    }
}

# Генерируем шаблонные, но качественные тексты для остальных планет в домах
def get_house_template(planet_name, house_num):
    house_meanings = {
        "1": "личности и внешности. Человек проявляет качества планеты активно и заметно.",
        "2": "денег и ресурсов. Планета влияет на способы заработка и траты.",
        "3": "общения и обучения. Влияние на интеллект, школу и ближайшее окружение.",
        "4": "дома и семьи. Планета создает атмосферу в родительском доме.",
        "5": "творчества и любви. Влияние на хобби, романтику и детей.",
        "6": "работы и здоровья. Планета показывает условия труда и болезни.",
        "7": "брака и партнерства. Описание типа партнера и отношений.",
        "8": "кризисов и чужих денег. Влияние на бизнес, секс и опасности.",
        "9": "путешествий и образования. Влияние на мировоззрение и удачу за границей.",
        "10": "карьеры и целей. Планета помогает или мешает в достижении успеха.",
        "11": "друзей и будущего. Влияние на планы, мечты и коллективы.",
        "12": "тайн и уединения. Планета проявляется скрыто, через подсознание."
    }
    return f"{planet_name} в {house_num} доме: Эта планета влияет на сферу {house_meanings[house_num]} Здесь ее энергия проявляется наиболее ярко в событиях жизни."

# === ОБНОВЛЕНИЕ ===
def update_all():
    if not TEXTS_FILE.exists(): return

    with open(TEXTS_FILE, "r", encoding="utf-8") as f:
        data = json.load(f)

    # 1. Обновляем знаки (оставшиеся)
    for planet, signs in social_transpersonal.items():
        if planet not in data["signs"]: data["signs"][planet] = {}
        for sign, text in signs.items():
            data["signs"][planet][sign] = text

    # 2. Обновляем дома (Солнце и Луна детально)
    for planet, houses in houses_texts.items():
        if planet not in data["houses"]: data["houses"][planet] = {}
        for house, text in houses.items():
            data["houses"][planet][house] = text

    # 3. Обновляем дома (остальные планеты шаблонно, но качественно)
    planets_ru = {
        "Mercury": "Меркурий", "Venus": "Венера", "Mars": "Марс", 
        "Jupiter": "Юпитер", "Saturn": "Сатурн", "Uranus": "Уран", 
        "Neptune": "Нептун", "Pluto": "Плутон", 
        "North_node": "Северный узел", "South_node": "Южный узел", "Lilith": "Лилит"
    }
    for p_key, p_name in planets_ru.items():
        if p_key not in data["houses"]: data["houses"][p_key] = {}
        for i in range(1, 13):
            h_key = str(i)
            if h_key not in data["houses"][p_key]: # Если нет уникального текста
                data["houses"][p_key][h_key] = get_house_template(p_name, h_key)

    # 4. Обновляем аспекты (базовые описания)
    # Это упрощенно, так как аспектов 700+. Сделаем их читаемыми.
    aspect_names = {
        "Conjunction": "Соединение", "Sextile": "Секстиль", 
        "Square": "Квадрат", "Trine": "Тригон", "Opposition": "Оппозиция"
    }
    
    for pair, aspects in data["aspects"].items():
        # Планеты могут содержать _ (например North_node), поэтому сплитим аккуратно
        # Но у нас ключи формируются как P1_P2. 
        # Если P1=North_node, P2=South_node -> North_node_South_node. Сплит по _ даст 4 части.
        # Проще перебрать известные планеты и найти совпадение.
        
        parts = pair.split("_")
        if len(parts) == 2:
            p1, p2 = parts
        elif len(parts) == 3: # Sun_North_node
            if parts[1] == "North" or parts[1] == "South": # Sun_North_node
                 p1 = parts[0]
                 p2 = f"{parts[1]}_{parts[2]}"
            else: # North_node_Sun
                 p1 = f"{parts[0]}_{parts[1]}"
                 p2 = parts[2]
        elif len(parts) == 4: # North_node_South_node
            p1 = f"{parts[0]}_{parts[1]}"
            p2 = f"{parts[2]}_{parts[3]}"
        else:
            p1, p2 = pair, pair # Fallback

        p1_ru = planets_ru.get(p1, p1)
        p2_ru = planets_ru.get(p2, p2)
        if p1 == "Sun": p1_ru = "Солнце"
        if p1 == "Moon": p1_ru = "Луна"
        if p2 == "Sun": p2_ru = "Солнце"
        if p2 == "Moon": p2_ru = "Луна"

        for asp_key, text in aspects.items():
            asp_name = aspect_names.get(asp_key, asp_key)
            if "ЗАПОЛНИТЬ" in text: # Переписываем только пустые
                if asp_key in ["Trine", "Sextile"]:
                    new_text = f"Гармоничный аспект: {asp_name} между {p1_ru} и {p2_ru}. Энергии планет помогают друг другу. Это ваши таланты и возможности, которые даются легко."
                elif asp_key in ["Square", "Opposition"]:
                    new_text = f"Напряженный аспект: {asp_name} между {p1_ru} и {p2_ru}. Конфликт энергий, создающий внутреннее напряжение. Требует проработки, но дает огромную энергию для роста."
                elif asp_key == "Conjunction":
                    new_text = f"Аспект соединения: {p1_ru} и {p2_ru} сливаются воедино. Мощная концентрация энергии. Может работать как в плюс, так и в минус, в зависимости от осознанности."
                else:
                    new_text = text
                data["aspects"][pair][asp_key] = new_text

    with open(TEXTS_FILE, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

if __name__ == "__main__":
    update_all()

