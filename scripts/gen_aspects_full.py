#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∞—Å–ø–µ–∫—Ç–æ–≤ —Å –Ω—É–ª—è"""

import json

# –ù–∞–∑–≤–∞–Ω–∏—è –ø–ª–∞–Ω–µ—Ç
PLANETS = {
    'Sun': ('–°–æ–ª–Ω—Ü–µ', '—Ç–≤–æ—ë –∏—Å—Ç–∏–Ω–Ω–æ–µ –Ø, –∂–∏–∑–Ω–µ–Ω–Ω–∞—è —Å–∏–ª–∞ –∏ –≤–æ–ª—è'),
    'Moon': ('–õ—É–Ω–∞', '—Ç–≤–æ–∏ —ç–º–æ—Ü–∏–∏, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∏—Ä'),
    'Mercury': ('–ú–µ—Ä–∫—É—Ä–∏–π', '—Ç–≤–æ–π —Ä–∞–∑—É–º, –æ–±—â–µ–Ω–∏–µ –∏ —Å–ø–æ—Å–æ–± –º—ã—à–ª–µ–Ω–∏—è'),
    'Venus': ('–í–µ–Ω–µ—Ä–∞', '—Ç–≤–æ—è –ª—é–±–æ–≤—å, –∫—Ä–∞—Å–æ—Ç–∞ –∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏'),
    'Mars': ('–ú–∞—Ä—Å', '—Ç–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è, —Å—Ç—Ä–∞—Å—Ç—å –∏ –≤–æ–ª—è –∫ –¥–µ–π—Å—Ç–≤–∏—é'),
    'Jupiter': ('–Æ–ø–∏—Ç–µ—Ä', '—Ç–≤–æ—è —É–¥–∞—á–∞, –º—É–¥—Ä–æ—Å—Ç—å –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ'),
    'Saturn': ('–°–∞—Ç—É—Ä–Ω', '—Ç–≤–æ–∏ –≥—Ä–∞–Ω–∏—Ü—ã, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –∏ —É—Ä–æ–∫–∏'),
    'Uranus': ('–£—Ä–∞–Ω', '—Ç–≤–æ—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å, —Å–≤–æ–±–æ–¥–∞ –∏ —Ä–µ–≤–æ–ª—é—Ü–∏—è'),
    'Neptune': ('–ù–µ–ø—Ç—É–Ω', '—Ç–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å –∏ –º–µ—á—Ç—ã'),
    'Pluto': ('–ü–ª—É—Ç–æ–Ω', '—Ç–≤–æ—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –≤–ª–∞—Å—Ç—å –∏ –≥–ª—É–±–∏–Ω–∞'),
    'North_node': ('–°–µ–≤. –£–∑–µ–ª', '—Ç–≤–æ—è –∫–∞—Ä–º–∏—á–µ—Å–∫–∞—è –º–∏—Å—Å–∏—è –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞'),
    'South_node': ('–Æ–∂–Ω. –£–∑–µ–ª', '—Ç–≤–æ–π –ø—Ä–æ—à–ª—ã–π –æ–ø—ã—Ç –∏ –∑–æ–Ω–∞ –∫–æ–º—Ñ–æ—Ä—Ç–∞'),
    'Lilith': ('–õ–∏–ª–∏—Ç', '—Ç–≤–æ—è —Ç–µ–Ω—å, –ø–æ–¥–∞–≤–ª–µ–Ω–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è –∏ —Å–∏–ª–∞'),
    'ASC': ('–ê—Å—Ü–µ–Ω–¥–µ–Ω—Ç', '—Ç–≤–æ—è –º–∞—Å–∫–∞, –ø–µ—Ä–≤–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –∏ –ø–æ–¥—Ö–æ–¥ –∫ –∂–∏–∑–Ω–∏'),
    'MC': ('–°–µ—Ä. –ù–µ–±–∞', '—Ç–≤–æ—ë –ø—Ä–∏–∑–≤–∞–Ω–∏–µ, —Ä–µ–ø—É—Ç–∞—Ü–∏—è –∏ –≤—ã—Å—à–∏–µ —Ü–µ–ª–∏'),
}

ASPECTS_RU = {
    '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ': '—Å–ª–∏—è–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–π —Å–æ–∑–¥–∞—ë—Ç –º–æ—â–Ω—ã–π —Ä–µ–∑–æ–Ω–∞–Ω—Å',
    '–°–µ–∫—Å—Ç–∏–ª—å': '–≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
    '–ö–≤–∞–¥—Ä–∞—Ç': '–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç –≤—ã–∑–æ–≤ –¥–ª—è —Ä–æ—Å—Ç–∞',
    '–¢—Ä–∏–≥–æ–Ω': '–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –≥–∞—Ä–º–æ–Ω–∏—è –¥–∞—Ä—É–µ—Ç –≤—Ä–æ–∂–¥—ë–Ω–Ω—ã–π —Ç–∞–ª–∞–Ω—Ç',
    '–ö–≤–∏–Ω–∫–æ–Ω—Å': '–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å',
    '–û–ø–ø–æ–∑–∏—Ü–∏—è': '–ø–æ–ª—è—Ä–Ω–æ—Å—Ç—å —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç–µ–π',
}

def generate_text(p1_key, p2_key, aspect_ru):
    p1_name, p1_desc = PLANETS.get(p1_key, (p1_key, p1_key))
    p2_name, p2_desc = PLANETS.get(p2_key, (p2_key, p2_key))
    aspect_effect = ASPECTS_RU.get(aspect_ru, aspect_ru)
    
    text = f"–ö–æ–≥–¥–∞ {p1_desc} –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å —Ç–µ–º, —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç {p2_desc}, {aspect_effect}. "
    text += f"–≠—Ç–æ—Ç –∞—Å–ø–µ–∫—Ç –º–µ–∂–¥—É {p1_name} –∏ {p2_name} –ø—Ä–∏–≥–ª–∞—à–∞–µ—Ç —Ç–µ–±—è –æ—Å–æ–∑–Ω–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —ç—Ç–∏—Ö —ç–Ω–µ—Ä–≥–∏–π –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–ª—è –¥—É—Ö–æ–≤–Ω–æ–π —ç–≤–æ–ª—é—Ü–∏–∏."
    
    return text

def main():
    with open('/opt/natal_chart/texts.json', 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    planets_list = list(PLANETS.keys())
    aspects_list = list(ASPECTS_RU.keys())
    
    count = 0
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤—Å–µ –ø–∞—Ä—ã
    for i, p1 in enumerate(planets_list):
        for p2 in planets_list[i+1:]:
            pair_key = f"{p1}_{p2}"
            
            if pair_key not in data['aspects']:
                data['aspects'][pair_key] = {}
            
            for aspect_ru in aspects_list:
                text = generate_text(p1, p2, aspect_ru)
                data['aspects'][pair_key][aspect_ru] = text
                count += 1
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º
    with open('/opt/natal_chart/texts.json', 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    
    print(f'‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ {count} —Ç–µ–∫—Å—Ç–æ–≤ –∞—Å–ø–µ–∫—Ç–æ–≤')
    print(f'üìä –ü–∞—Ä –ø–ª–∞–Ω–µ—Ç: {len(data["aspects"])}')

if __name__ == '__main__':
    main()
